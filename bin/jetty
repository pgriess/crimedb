#!/bin/bash -x
#
# Wrapper to start Jetty.
#
# This exists to use the configuration checked in to Git rather than whatever
# default crap the installation dumps on disk.

export JETTY_HOME=${JETTY_HOME:-$HOME/src/jetty-distribution-9.0.4.v20130625}
export JAVA_HOME=${JAVA_HOME:-$(/usr/libexec/java_home)}
export CRIMEDB_HOME=${CRIMEDB_HOME:-$(readlink -f $(dirname $0)/..)}
export SOLR_HOME=${SOLR_HOME:-$(readlink -f $(dirname $0)/../solr)}

cd $CRIMEDB_HOME/jetty

$JAVA_HOME/bin/java \
    -Djetty.home=$JETTY_HOME \
    -Dsolr.solr.home=$SOLR_HOME \
    -jar $JETTY_HOME/start.jar \
    lib=$CRIMEDB_HOME/jetty/ext
